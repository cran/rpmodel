<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Beni Stocker" />


<title>Running the P-model in R</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Running the P-model in R</h1>
<h4 class="author">Beni Stocker</h4>



<p>The rpmodel package implements the P-model as described in Stocker et
al. (2019) <em>Geosci. Mod. Dev.</em> The main function available
through the package is <code>rpmodel()</code>, which returns a list of
quantities (see <code>?rpmodel</code>) for a given set of inputs. An
additional set of important functions that are used within
<code>rpmodel()</code> are also available through this package. Usage
examples are given below.</p>
<p><strong>Important note:</strong></p>
<p>The P-model predicts how photosynthesis acclimates to a changing
environment, coordinating stomatal conductance, Vcmax and Jmax. This
yields a model that has the form of a light use efficiency model, where
gross primary production scales linearly with absorbed light, as
described in <a href="https://doi.org/10.5194/gmd-13-1545-2020">Stocker
et al. 2020</a>. It is important to note that this implies that the
P-model is valid only for simulating responses to the environment that
evolve over the time scale at which the photosynthetic machinery (e.g.,
Rubisco) can be assumed to acclimate. Sensible choices are on the order
of a couple of weeks to a month. In other words, the arguments (climatic
forcing), provided to <code>rpmodel()</code> should represent typical
daytime mean values, averaged across a couple of weeks. The output is
then representative also for average values across the same time
scale.</p>
<div id="example-p-model-run" class="section level2">
<h2>Example P-model run</h2>
<p>Let’s run the P-model, without <span class="math inline">\(J_{\text{max}}\)</span> limitation (argument
<code>method_jmaxlim = &quot;none&quot;</code>), for one point. The set of inputs,
being temperature (<code>tc</code>), photosynthetic photon flux density
(<code>ppfd</code>), vapour pressure deficit (<code>vpd</code>), ambient
CO<span class="math inline">\(_2\)</span> (<code>co2</code>), elevation
(<code>elv</code>), and fraction of absorbed photosynthetically active
radiation (<code>fapar</code>). The quantum yield efficiency parameter
is provided as an argument (<code>kphio</code>) and corresponds to <span class="math inline">\(\widehat{\varphi_0}\)</span> in Stocker et
al. (2019) if the temperature-dependence of this parameter is ignored
(argument <code>do_ftemp_kphio = FALSE</code>, corresponding to
simulation setup ‘ORG’ in Stocker et al. (2019)), or to <span class="math inline">\(\widehat{c_L}\)</span> if the
temperature-dependence of the quantum yield efficiency is included
(argument <code>do_ftemp_kphio = TRUE</code>, used in simulation setups
‘BRC’ and ‘FULL’ in Stocker et al. (2019)). By default the optional
argument <code>do_soilmstress</code> is set to <code>FALSE</code>,
meaning that the empirical soil moisture stress function is not
included. The unit cost ratio (<span class="math inline">\(\beta\)</span> in Stocker et al. (2019)) is given
by argument <code>beta</code>.</p>
<p>To run the <code>rpmodel()</code> function we can do:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(rpmodel)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>out_pmodel <span class="ot">&lt;-</span> <span class="fu">rpmodel</span>( </span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="at">tc             =</span> <span class="dv">20</span>,           <span class="co"># temperature, deg C</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  <span class="at">vpd            =</span> <span class="dv">1000</span>,         <span class="co"># Pa,</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="at">co2            =</span> <span class="dv">400</span>,          <span class="co"># ppm,</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="at">fapar          =</span> <span class="dv">1</span>,            <span class="co"># fraction  ,</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="at">ppfd           =</span> <span class="dv">30</span>,           <span class="co"># mol/m2/d,</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>  <span class="at">elv            =</span> <span class="dv">0</span>,            <span class="co"># m.a.s.l.,</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  <span class="at">kphio          =</span> <span class="fl">0.049977</span>,     <span class="co"># quantum yield efficiency as calibrated for setup ORG by Stocker et al. 2020 GMD,</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>  <span class="at">beta           =</span> <span class="dv">146</span>,          <span class="co"># unit cost ratio a/b,</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>  <span class="at">c4             =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  <span class="at">method_jmaxlim =</span> <span class="st">&quot;wang17&quot;</span>,</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>  <span class="at">do_ftemp_kphio =</span> <span class="cn">FALSE</span>,        <span class="co"># corresponding to setup ORG</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>  <span class="at">do_soilmstress =</span> <span class="cn">FALSE</span>,        <span class="co"># corresponding to setup ORG</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>  <span class="at">verbose        =</span> <span class="cn">TRUE</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning in rpmodel(tc = 20, vpd = 1000, co2 = 400, fapar = 1, ppfd = 30, : Atmospheric pressure (patm) not provided. Calculating it as a
##       function of elevation (elv), assuming standard atmosphere 
##       (101325 Pa at sea level).</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">print</span>(out_pmodel)</span></code></pre></div>
<pre><code>## $gpp
## [1] 7.119192
## 
## $ca
## [1] 40.53
## 
## $gammastar
## [1] 3.339251
## 
## $kmm
## [1] 46.09928
## 
## $ns_star
## [1] 1.125361
## 
## $chi
## [1] 0.694352
## 
## $xi
## [1] 63.3145
## 
## $mj
## [1] 0.7123038
## 
## $mc
## [1] 0.3340838
## 
## $ci
## [1] 28.14209
## 
## $iwue
## [1] 7.742446
## 
## $gs
## [1] 0.04784805
## 
## $vcmax
## [1] 1.774218
## 
## $vcmax25
## [1] 2.78494
## 
## $jmax
## [1] 4.001452
## 
## $jmax25
## [1] 5.464979
## 
## $rd
## [1] 0.02818463</code></pre>
<p>Above, we specified the model paramters (arguments <code>beta</code>
and <code>kphio</code>). This overrides the defaults, where
<code>rpmodel()</code> uses the parameters as calibrated by Stocker et
al. (2019), depending on the choices for arguments
<code>do_ftemp_kphio</code> and <code>do_soilmstress</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>kphio <span class="ot">=</span> <span class="fu">ifelse</span>(do_ftemp_kphio, <span class="fu">ifelse</span>(do_soilmstress, <span class="fl">0.087182</span>, <span class="fl">0.081785</span>), <span class="fl">0.049977</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>beta <span class="ot">=</span> <span class="fl">146.0</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>apar_soilm <span class="ot">=</span> <span class="fl">0.0</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>bpar_soilm <span class="ot">=</span> <span class="fl">0.73300</span></span></code></pre></div>
<p>The function returns a list of variables (see also man page by
<code>?rpmodel</code>), including <span class="math inline">\(V_{\mathrm{cmax}}\)</span>, <span class="math inline">\(g_s\)</span>, and all the parameters of the
photosynthesis model (<span class="math inline">\(K\)</span>, <span class="math inline">\(\Gamma^{\ast}\)</span>), which are all internally
consistent, as can be verified for…</p>
<p><span class="math display">\[
c_i = c_a - A / g_s = \chi c_a
\]</span></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>c_molmass <span class="ot">&lt;-</span> <span class="fl">12.0107</span>  <span class="co"># molecular mass of carbon</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>kphio <span class="ot">&lt;-</span> <span class="fl">0.05</span>         <span class="co"># quantum yield efficiency, value as used in the function call to rpmodel()</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>ppfd <span class="ot">&lt;-</span> <span class="dv">30</span>            <span class="co"># mol/m2/d, value as used in the function call to rpmodel()</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>fapar <span class="ot">&lt;-</span> <span class="dv">1</span>            <span class="co"># fraction, value as used in the function call to rpmodel()</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">print</span>( out_pmodel<span class="sc">$</span>ci )</span></code></pre></div>
<pre><code>## [1] 28.14209</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">print</span>( out_pmodel<span class="sc">$</span>ca <span class="sc">-</span> (out_pmodel<span class="sc">$</span>gpp <span class="sc">/</span> c_molmass) <span class="sc">/</span> out_pmodel<span class="sc">$</span>gs )</span></code></pre></div>
<pre><code>## [1] 28.14209</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">print</span>( out_pmodel<span class="sc">$</span>ca <span class="sc">*</span> out_pmodel<span class="sc">$</span>chi )</span></code></pre></div>
<pre><code>## [1] 28.14209</code></pre>
<p>Yes.</p>
<p>And for… <span class="math display">\[
A = V_{\text{cmax}} \frac{c_i-\Gamma^{\ast}}{c_i + K} = \phi_0
I_{\text{abs}} \frac{c_i-\Gamma^{\ast}}{c_i + 2 \Gamma^{\ast}} = g_s
(c_a - c_i)
\]</span></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">print</span>( out_pmodel<span class="sc">$</span>gpp <span class="sc">/</span> c_molmass )</span></code></pre></div>
<pre><code>## [1] 0.5927375</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">print</span>( out_pmodel<span class="sc">$</span>vcmax <span class="sc">*</span> (out_pmodel<span class="sc">$</span>ci <span class="sc">-</span> out_pmodel<span class="sc">$</span>gammastar) <span class="sc">/</span> (out_pmodel<span class="sc">$</span>ci <span class="sc">+</span> out_pmodel<span class="sc">$</span>kmm ))</span></code></pre></div>
<pre><code>## [1] 0.5927375</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">print</span>( out_pmodel<span class="sc">$</span>gs <span class="sc">*</span> (out_pmodel<span class="sc">$</span>ca <span class="sc">-</span> out_pmodel<span class="sc">$</span>ci) )</span></code></pre></div>
<pre><code>## [1] 0.5927375</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">print</span>( kphio <span class="sc">*</span> ppfd <span class="sc">*</span> fapar <span class="sc">*</span> (out_pmodel<span class="sc">$</span>ci <span class="sc">-</span> out_pmodel<span class="sc">$</span>gammastar) <span class="sc">/</span> (out_pmodel<span class="sc">$</span>ci <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> out_pmodel<span class="sc">$</span>gammastar ))</span></code></pre></div>
<pre><code>## [1] 1.068456</code></pre>
<p>Yes.</p>
<div id="elevation-and-pressure" class="section level3">
<h3>Elevation and pressure</h3>
<p>Above, atmospheric pressure (<code>patm</code>) was not provided as
an argument, but elevation (<code>elv</code>) was. Hence the warning was
printed (only when <code>verbose = TRUE</code>), saying:
<code>Atmospheric pressure (patm) not provided. Calculating it as a function of elevation (elv),</code>
<code>Assuming standard atmosphere (101325 Pa at sea level).</code>.
Alternatively, we can provide atmospheric pressure (<code>patm</code>)
as input, which overrides the argument <code>elv</code>.</p>
</div>
<div id="p-model-for-time-series" class="section level3">
<h3>P-model for time series</h3>
<p>The <code>rpmodel()</code> function can also be invoked for time
series, where <code>tc</code>, <code>vpd</code>, <code>co2</code>,
<code>fapar</code>, <code>patm</code>, and <code>ppfd</code> are
vectors.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1982</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>out_ts_pmodel <span class="ot">&lt;-</span> <span class="fu">rpmodel</span>( </span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  <span class="at">tc             =</span> <span class="dv">20</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  <span class="at">vpd            =</span> <span class="dv">1000</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">50</span>),</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  <span class="at">co2            =</span> <span class="fu">rep</span>(<span class="dv">400</span>, <span class="dv">5</span>),</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>  <span class="at">fapar          =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">5</span>),</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>  <span class="at">ppfd           =</span> <span class="dv">30</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>),</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>  <span class="at">elv            =</span> <span class="dv">0</span>,         </span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  <span class="at">kphio          =</span> <span class="fl">0.049977</span>,</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>  <span class="at">beta           =</span> <span class="dv">146</span>,</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>  <span class="at">c4             =</span> <span class="cn">FALSE</span>,</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>  <span class="at">method_jmaxlim =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>  <span class="at">do_ftemp_kphio =</span> <span class="cn">TRUE</span>,</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>  <span class="at">do_soilmstress =</span> <span class="cn">FALSE</span>,</span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>  <span class="at">verbose        =</span> <span class="cn">FALSE</span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning in sqrt((1/fact_jmaxlim)^2 - 1): NaNs produced</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">print</span>(out_ts_pmodel<span class="sc">$</span>gpp)</span></code></pre></div>
<pre><code>## [1] 8.162522 7.967237 8.148933 7.468270 8.968635</code></pre>
<p>Note that <code>gpp</code> (as well as all other returned variables)
are now vectors of the same length as the vectors provided as
inputs.</p>
</div>
<div id="p-model-in-the-tidyverse" class="section level3">
<h3>P-model in the tidyverse</h3>
<p>We can create a data frame (in <a href="https://www.tidyverse.org/">tidyverse</a> this is a tibble) and
apply the <code>rpmodel()</code> function to each row.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1982</span>)</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>  <span class="at">tc             =</span> <span class="dv">20</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>  <span class="at">vpd            =</span> <span class="dv">1000</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">50</span>),</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>  <span class="at">co2            =</span> <span class="fu">rep</span>(<span class="dv">400</span>, <span class="dv">5</span>),</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>  <span class="at">fapar          =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">5</span>),</span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>  <span class="at">ppfd           =</span> <span class="dv">30</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">out_pmodel =</span> purrr<span class="sc">::</span><span class="fu">pmap</span>(., rpmodel, </span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a>    <span class="at">elv            =</span> <span class="dv">0</span>,         </span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a>    <span class="at">kphio          =</span> <span class="fl">0.049977</span>,</span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a>    <span class="at">beta           =</span> <span class="dv">146</span>,</span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a>    <span class="at">c4             =</span> <span class="cn">FALSE</span>,</span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a>    <span class="at">method_jmaxlim =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb24-19"><a href="#cb24-19" tabindex="-1"></a>    <span class="at">do_ftemp_kphio =</span> <span class="cn">FALSE</span></span>
<span id="cb24-20"><a href="#cb24-20" tabindex="-1"></a>    ) )</span>
<span id="cb24-21"><a href="#cb24-21" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" tabindex="-1"></a><span class="fu">print</span>(df)</span></code></pre></div>
<p>Note that the new column <code>out_pmodel</code> now contains the
list returned as output of the <code>rpmodel()</code> function applied
to each row separately. Additional (constant) arguments are just passed
to <code>purrr::pmap</code> as arguments.</p>
<p>If you prefer the elements of these lists to be in separate columns
of <code>df</code>, use tidyr to do:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">out_pmodel =</span> purrr<span class="sc">::</span><span class="fu">map</span>(out_pmodel, <span class="sc">~</span><span class="fu">as_tibble</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>  <span class="fu">unnest</span>(out_pmodel)</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="fu">print</span>(df)</span></code></pre></div>
</div>
<div id="c4-photosynthesis" class="section level3">
<h3>C4 photosynthesis</h3>
<p>Photosynthesis by C4 plants is simulated by the P-model based on the
assumption that the “CO2 limitation term” in the FvCB model (Eq. 11 in
Stocker et al., 2020) is 1 (no limitation), and based on a distinct
parametrisation of the quantum yield efficiency and its temperature
dependence <span class="math inline">\(\varphi_0\)</span>, following Cai
&amp; Prentice, 2020. Under identical conditions, GPP of C3 and C4
photosynthesis are different:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>out_c3 <span class="ot">&lt;-</span> <span class="fu">rpmodel</span>( </span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>  <span class="at">tc             =</span> <span class="dv">20</span>,           <span class="co"># temperature, deg C</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>  <span class="at">vpd            =</span> <span class="dv">1000</span>,         <span class="co"># Pa,</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>  <span class="at">co2            =</span> <span class="dv">400</span>,          <span class="co"># ppm,</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>  <span class="at">fapar          =</span> <span class="dv">1</span>,            <span class="co"># fraction  ,</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>  <span class="at">ppfd           =</span> <span class="dv">30</span>,           <span class="co"># mol/m2/d,</span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>  <span class="at">elv            =</span> <span class="dv">0</span>,            <span class="co"># m.a.s.l.,</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>  <span class="at">c4             =</span> <span class="cn">FALSE</span></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>  )</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>out_c4 <span class="ot">&lt;-</span> <span class="fu">rpmodel</span>( </span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>  <span class="at">tc             =</span> <span class="dv">20</span>,           <span class="co"># temperature, deg C</span></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a>  <span class="at">vpd            =</span> <span class="dv">1000</span>,         <span class="co"># Pa,</span></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a>  <span class="at">co2            =</span> <span class="dv">400</span>,          <span class="co"># ppm,</span></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a>  <span class="at">fapar          =</span> <span class="dv">1</span>,            <span class="co"># fraction  ,</span></span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a>  <span class="at">ppfd           =</span> <span class="dv">30</span>,           <span class="co"># mol/m2/d,</span></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a>  <span class="at">elv            =</span> <span class="dv">0</span>,            <span class="co"># m.a.s.l.,</span></span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a>  <span class="at">c4             =</span> <span class="cn">TRUE</span></span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning in rpmodel(tc = 20, vpd = 1000, co2 = 400, fapar = 1, ppfd = 30, : rpmodel(): light and Rubisco-limited assimilation rates are not identical.
## Mean relative difference: 1.582923</code></pre>
<pre><code>## Warning in rpmodel(tc = 20, vpd = 1000, co2 = 400, fapar = 1, ppfd = 30, : rpmodel(): Assimilation and GPP are not identical.
## Mean relative difference: 1.582923</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">print</span>(out_c3<span class="sc">$</span>gpp)</span></code></pre></div>
<pre><code>## [1] 7.642545</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">print</span>(out_c4<span class="sc">$</span>gpp)</span></code></pre></div>
<pre><code>## [1] 126.2565</code></pre>
<p>To accurately simulate C3 photosynthesis, a constant scalar was
calibrated by Stocker et al., 2020 to GPP from FLUXNET2015 data and
scaled in their ‘BRC’ and ‘FULL’ setup with a temperature dependence
factor (their Eq. 20). The implementation of C3 photosynthesis in
rpmodel uses <code>kphio</code> as a constant scalar, provided to
<code>rpmodel()</code> as an argument, and representing <span class="math inline">\((a_L b_L)/4\)</span> in their Eq. 20. The
temprature dependence is calculated based on Bernacchi et al., 2003
using the function <code>ftemp_kphio()</code>.</p>
<p>The implementation of C4 photosynthesis uses a different temperature
dependence of <span class="math inline">\(\varphi_0\)</span> following
Eq. 5 in Cai &amp; Prentice (2020), implemented by
<code>ftemp_kphio(c4 = TRUE)</code>. The calibratable parameter
<code>kphio</code> doesn’t appear explicitly in Eq. 5 by Cai &amp;
Prentice (2020), but is implemented the same way in rpmodel as for C3
photosynthesis. It should therefore be regarded as a “correction”
factor, where <code>kphio = 1.0</code> means “no correction” and
reflects the parametrisation used by Cai &amp; Prentice (2020).</p>
<p>The following shows <span class="math inline">\(\varphi(T)\)</span>,
corresponding to <code>kphio * ftemp_kphio()</code>, using parameters as
in Stocker et al., 2020 for C3 vegetation (their ‘BRC’ setup, black line
in the plot below), and as in Cai &amp; Prentice (2020) for C4
vegetation (blue solid line).</p>
<p>Addendum: As of <a href="https://github.com/geco-bern/rpmodel/issues/19">issue #19</a>
(raised by David Orme), the values provided in Cai &amp; Prentice (2020)
are erroneous. And instead, the temperature response function for C4
should be <code>ftemp = -0.064 + 0.03 * tc - 0.000464 * tc^2</code>.
This is now also implemented in rpmodel.</p>
</div>
</div>
<div id="auxiliary-functions" class="section level2">
<h2>Auxiliary functions</h2>
<p>A number of auxiliary functions, which are used within
<code>rpmodel()</code>, are available (public) through the package.</p>
<div id="instantaneous-temperature-scaling" class="section level3">
<h3>Instantaneous temperature scaling</h3>
<p>Different instantaneous temperature scaling functions are applied for
<span class="math inline">\(V_\text{cmax}\)</span> and dark respiration
(<span class="math inline">\(R_d\)</span>).</p>
<ul>
<li><code>ftemp_inst_vcmax()</code> calculates the instantaneous
temperature response of <span class="math inline">\(V_\text{cmax}\)</span>. Let’s run the P-model for
<code>tc = 10</code> (degrees C). The ratio of <span class="math inline">\(V_\text{cmax}/V_\text{cmax25}\)</span> should
equal the instantaneous temperature scaling function for <span class="math inline">\(V_\text{cmax}\)</span> at 10 degrees C (calculated
by <code>ftemp_inst_vcmax(10)</code>):</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>out_pmodel <span class="ot">&lt;-</span> <span class="fu">rpmodel</span>( </span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>  <span class="at">tc             =</span> <span class="dv">10</span>,           <span class="co"># temperature, deg C</span></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>  <span class="at">vpd            =</span> <span class="dv">1000</span>,         <span class="co"># Pa,</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>  <span class="at">co2            =</span> <span class="dv">400</span>,          <span class="co"># ppm,</span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>  <span class="at">fapar          =</span> <span class="dv">1</span>,            <span class="co"># fraction  ,</span></span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>  <span class="at">ppfd           =</span> <span class="dv">30</span>,           <span class="co"># mol/m2/d,</span></span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>  <span class="at">elv            =</span> <span class="dv">0</span>,            <span class="co"># m.a.s.l.,</span></span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a>  <span class="at">kphio          =</span> <span class="fl">0.049977</span>,     <span class="co"># quantum yield efficiency as calibrated for setup ORG by Stocker et al. 2020 GMD,</span></span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>  <span class="at">beta           =</span> <span class="dv">146</span>,          <span class="co"># unit cost ratio a/b,</span></span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a>  <span class="at">method_jmaxlim =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a>  <span class="at">do_ftemp_kphio =</span> <span class="cn">FALSE</span>,</span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>  <span class="at">verbose        =</span> <span class="cn">TRUE</span></span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning in rpmodel(tc = 10, vpd = 1000, co2 = 400, fapar = 1, ppfd = 30, : Atmospheric pressure (patm) not provided. Calculating it as a
##       function of elevation (elv), assuming standard atmosphere 
##       (101325 Pa at sea level).</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Ratio Vcmax/Vcmax25      :&quot;</span>, out_pmodel<span class="sc">$</span>vcmax<span class="sc">/</span>out_pmodel<span class="sc">$</span>vcmax25))</span></code></pre></div>
<pre><code>## [1] &quot;Ratio Vcmax/Vcmax25      : 0.260975632963417&quot;</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;ftemp_inst_vcmax(10):&quot;</span>, <span class="fu">ftemp_inst_vcmax</span>(<span class="dv">10</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;ftemp_inst_vcmax(10): 0.260975632963417&quot;</code></pre>
<ul>
<li><p><code>ftemp_arrh()</code> Calculates the Arrhenius-type
temperature response and is used inside
<code>ftemp_inst_vcmax()</code>.</p></li>
<li><p><code>ftemp_inst_rd()</code> calculates the temperature response
of dark respiration (<span class="math inline">\(R_d\)</span>), which is
slightly less steep than that for <span class="math inline">\(V_\text{cmax}\)</span>:</p></li>
</ul>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;ftemp_inst_rd(10):&quot;</span>, <span class="fu">ftemp_inst_rd</span>(<span class="dv">10</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;ftemp_inst_rd(10): 0.284933345928884&quot;</code></pre>
</div>
<div id="parameters-in-the-fvcb-model" class="section level3">
<h3>Parameters in the FvCB model</h3>
<ul>
<li><code>calc_gammastar()</code> calculates the CO<span class="math inline">\(_2\)</span> compensation point (<span class="math inline">\(\Gamma^\ast\)</span>) in the Farquhar-von
Caemmerer-Berry model as a function of temperature (argument
<code>tc</code>) and atmospheric pressure (argument <code>patm</code>).
This is returned by the <code>rpmodel()</code> function and by the
separate auxiliary function <code>calc_gammastar()</code>.
<code>calc_gammastar()</code> requires atmospheric pressure
(<code>patm</code>) to be given as an argument (in addition to
temperature). Corresponding to the <code>rpmodel()</code> call above,
let’s calculate this using the auxiliary function
<code>calc_patm()</code> with 0 metres above sea level, and assuming
standard atmospheric pressure (101325 Pa at 0 m a.s.l.):</li>
</ul>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;From rpmodel call :&quot;</span>, out_pmodel<span class="sc">$</span>gammastar))</span></code></pre></div>
<pre><code>## [1] &quot;From rpmodel call : 1.93016150706341&quot;</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;gammastar(10):&quot;</span>, <span class="fu">calc_gammastar</span>(<span class="dv">10</span>, <span class="at">patm =</span> <span class="fu">calc_patm</span>(<span class="at">elv =</span> <span class="dv">0</span>))))</span></code></pre></div>
<pre><code>## [1] &quot;gammastar(10): 1.93016150706341&quot;</code></pre>
<ul>
<li><code>calc_kmm()</code> calculates the Michaelis Menten coefficient
for Rubisco-limited photosynthesis as a function of temperature
(argument <code>tc</code>) and atmospheric pressure (argument
<code>patm</code>). As above, <code>calc_kmm()</code> requires
atmospheric pressure to be given as an argument (in addition to
temperature). Corresponding to the <code>rpmodel()</code> call above,
let’s calculate this using the auxiliary function
<code>calc_patm()</code> with 0 metres above sea level, and assuming
standard atmospheric pressure (101325 Pa at 0 m a.s.l.):</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;From rpmodel call:&quot;</span>, out_pmodel<span class="sc">$</span>kmm))</span></code></pre></div>
<pre><code>## [1] &quot;From rpmodel call: 19.6242174524746&quot;</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;kmm(10)     :&quot;</span>, <span class="fu">calc_kmm</span>(<span class="dv">10</span>, <span class="at">patm =</span> <span class="fu">calc_patm</span>(<span class="at">elv =</span> <span class="dv">0</span>))))</span></code></pre></div>
<pre><code>## [1] &quot;kmm(10)     : 19.6242174524746&quot;</code></pre>
</div>
<div id="temperature-dependence-of-quantum-yield-efficiency" class="section level3">
<h3>Temperature dependence of quantum yield efficiency</h3>
<p>The temperature dependence of quantum yield efficiency is modelled
following Bernacchi et al. (2003), if the argument to the
<code>rpmodel()</code> call <code>do_ftemp_kphio = TRUE</code>. This
affects several quantities returned by the <code>rpmodel()</code> call
(GPP, LUE, Vcmax), and can be calculated direction using
<code>ftemp_kphio()</code>.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>out_pmodel_ftemp_kphio_ON <span class="ot">&lt;-</span> <span class="fu">rpmodel</span>( </span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>  <span class="at">tc             =</span> <span class="dv">20</span>,           <span class="co"># temperature, deg C</span></span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>  <span class="at">vpd            =</span> <span class="dv">1000</span>,         <span class="co"># Pa,</span></span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a>  <span class="at">co2            =</span> <span class="dv">400</span>,          <span class="co"># ppm,</span></span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>  <span class="at">fapar          =</span> <span class="dv">1</span>,            <span class="co"># fraction  ,</span></span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>  <span class="at">ppfd           =</span> <span class="dv">30</span>,           <span class="co"># mol/m2/d,</span></span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a>  <span class="at">elv            =</span> <span class="dv">0</span>,            <span class="co"># m.a.s.l.,</span></span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a>  <span class="at">do_ftemp_kphio =</span> <span class="cn">TRUE</span></span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a>  )</span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a>out_pmodel_ftemp_kphio_OFF <span class="ot">&lt;-</span> <span class="fu">rpmodel</span>( </span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a>  <span class="at">tc             =</span> <span class="dv">20</span>,           <span class="co"># temperature, deg C</span></span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a>  <span class="at">vpd            =</span> <span class="dv">1000</span>,         <span class="co"># Pa,</span></span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a>  <span class="at">co2            =</span> <span class="dv">400</span>,          <span class="co"># ppm,</span></span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a>  <span class="at">fapar          =</span> <span class="dv">1</span>,            <span class="co"># fraction  ,</span></span>
<span id="cb49-15"><a href="#cb49-15" tabindex="-1"></a>  <span class="at">ppfd           =</span> <span class="dv">30</span>,           <span class="co"># mol/m2/d,</span></span>
<span id="cb49-16"><a href="#cb49-16" tabindex="-1"></a>  <span class="at">elv            =</span> <span class="dv">0</span>,            <span class="co"># m.a.s.l.,</span></span>
<span id="cb49-17"><a href="#cb49-17" tabindex="-1"></a>  <span class="at">do_ftemp_kphio =</span> <span class="cn">FALSE</span></span>
<span id="cb49-18"><a href="#cb49-18" tabindex="-1"></a>  )</span>
<span id="cb49-19"><a href="#cb49-19" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;LUE ftemp_ON /LUE ftemp_OFF =&quot;</span>, out_pmodel_ftemp_kphio_ON<span class="sc">$</span>lue <span class="sc">/</span> out_pmodel_ftemp_kphio_OFF<span class="sc">$</span>lue))</span></code></pre></div>
<pre><code>## [1] &quot;LUE ftemp_ON /LUE ftemp_OFF = &quot;</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;GPP ftemp_ON /GPP ftemp_OFF =&quot;</span>, out_pmodel_ftemp_kphio_ON<span class="sc">$</span>gpp <span class="sc">/</span> out_pmodel_ftemp_kphio_OFF<span class="sc">$</span>gpp))</span></code></pre></div>
<pre><code>## [1] &quot;GPP ftemp_ON /GPP ftemp_OFF = 1.07351301598735&quot;</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Vcmax ftemp_ON /Vcmax ftemp_OFF =&quot;</span>, out_pmodel_ftemp_kphio_ON<span class="sc">$</span>vcmax <span class="sc">/</span> out_pmodel_ftemp_kphio_OFF<span class="sc">$</span>vcmax))</span></code></pre></div>
<pre><code>## [1] &quot;Vcmax ftemp_ON /Vcmax ftemp_OFF = 1.07351301598735&quot;</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;ftemp_kphio(20) =&quot;</span>, <span class="fu">ftemp_kphio</span>(<span class="dv">20</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;ftemp_kphio(20) = 0.656&quot;</code></pre>
</div>
<div id="soil-moisture-stress" class="section level3">
<h3>Soil moisture stress</h3>
<p>The soil moisture stress function is available as a separate public
function.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>vec_soilm <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">1.0</span>, <span class="at">to =</span> <span class="fl">0.0</span>, <span class="at">by =</span> <span class="sc">-</span><span class="fl">0.05</span>)</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a>vec_soilmstress <span class="ot">&lt;-</span> <span class="fu">calc_soilmstress</span>( vec_soilm, <span class="at">meanalpha =</span> <span class="fl">1.0</span>, <span class="at">apar_soilm =</span> <span class="fl">0.0</span>, <span class="at">bpar_soilm =</span> <span class="fl">0.7330</span> )</span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a><span class="fu">plot</span>(vec_soilm, vec_soilmstress)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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BCJDgAQUGfS8MBEgAiQgPgNEgAhEhgAJKDLoeWEiQARIQHwGiAARiAwBElBk0PPCRIAIkID4DBABIhAZAiSgyKDnhYkAESAB8RkgAkQgMgRIQJFBzwsTASJAAuIzQASIQGQIkIAig54XJgJEgATEZ4AIEIHIECABRQY9L0wEiAAJiM8AESACkSFAAooMel6YCBABEhCfASJABCJDgAQUGfS8MBEgAiQgPgNEgAhEhgAJKDLoeWEiQARIQHwGiAARiAwBElBk0PPCRIAIrJErBM45WW211Wz3JUuWyLRp02T33XeXTTfdNNdTlNR+t9xyi9x+++2y3nrrldR9JfFm8Gz+8ccf1vQaNWr4z6l3L3/++afgg+d39dVXz7od2/BJFZwbx+J/tu2VXbu62hbU9rC2rb322jJ27FipU6dO6i3F6vtqehMurEVDhw6VIUOGyLx58+Tjjz+Wli1byvfffy/o7HHjxskhhxwSdoqS277bbrvJlVdeSQIqQs++9dZbgg+IYJdddrEfPu+yd911lzz66KPSqFEjWbFihT2fo0ePlq233tpIacCAAfZjieUvvvhCvv76a3nuuees37B/nz59ZNGiRdKwYUN55513pHbt2vL000/LGmusIV9++aWcc845RjwbbrihzJo1Sw4//HC58MILjcTeeOMNufTSS2WTTTaRtdZaS959913p2bOnnHzyyda8xx57TIYNGyZbbbWV/P777/L+++/LzTff7Lf/pptukmeeeUYaN25s7xPa8fjjj8tmm21m+19yySV2zSZNmsiCBQvk559/tv3Rxh9++EF69+4t33zzjWy++eaGD/4/9NBD9l6iAfvtt59Mnz5ddt55Zw+u+P0HAVUmH3zwgdPOcKeffrrTB8D+b7TRRm7q1KnuP//5j/vnP/9Z2eElu61Vq1aGQcneYExu7JhjjnHbb7+9u/zyy90VV1yBH0vXoUMHp6MOd8cdd9jy0qVL/dY+8sgjtg7P50477eT0R9L9+uuv/vazzjrLtusLbf/btWvnb8MXJSLXrFkzp2Rg26+66ip/+y+//GLrLrjgAqdkZd+ff/55f7sSlq1T0nM68rDv+oPtb1cysHVPPPGE+9e//mXfly9f7m+/7bbbbN3s2bPdBhts4HR24VatWuVv79y5s23/9NNP7f8JJ5zgb8N+uNd99tnHKdnZetz/22+/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/fbb5c8//0zbp7KF5cuXy8knnyz169e36+AcM2bMSDtkypQp0qZNG1lvvfWsHX379pXffvvN3wfHjBo1yl9O/TJgwAC55JJLZOTIkbLTTjvJZpttJr169RLnnNx2223StGlT2WGHHWTw4MGph/F7oRHQDqCUKQI//fSTq127trvuuuvSENh///1d586dbd28efNcrVq1XPPmzd2IESPc0KFDnRKRO/bYY/1jFi5c6DbeeGN36KGHujFjxrhLL73U1axZ091///3+PmFfTjzxRLfFFls4HcU4JUDXtm1bt9Zaa7lvvvnGDn3rrbdcjRo13GGHHeaeeOIJp0Th/vGPf7gOHTr4p65bt6675pprbPnJJ590+u64r776ypZ79OjhlNxckyZN3JAhQ1zPnj1t+wEHHOC23XZbO99pp51m62bNmuWfk18KiwB+AShljMDxxx/vdt99dx8BVdrai/7YY4/Zuq5duxrhrFy50t/n0UcfTXtRQUZ4sf/44w9/n9NPP921bt3aXw77stVWWzkdWfm7ffHFFw6kpKMvW6cjHyNBHVX5+3gk8/LLL9u6MAICIb333nv+8Q0bNrT7+Oijj/x1IEEdLfnL/FJYBKgDKvQQM+bnVwKSQw45RD755BNp0KCBKPHIuuuuKzrSsJZPmjRJ9t13X5k7d65/J5tssomsvvrqMnXqVNlll13k7bffli5dutg6bydMwWCFylVatGghN954o/z888/SqVMn2Xvvvf3plL4CMnPmTME0KvWc2E9HQfLaa6+JjtpCL4V2N2vWzN8PCmsdqUnjxo39dZtvvrnMnz/fX+aXwiJAHVBh8Y392Q888EDT24B4II888ojoqEd0+mNksHTpUtGRhumKoC/CB3oY6HegO8L/Dz/8UDbddNO0e00lirQNWRaGDx8u7du3F50emQ4JuqDLL7/czv/1119bW0AOmYJ1n3/+eebqwOXM43VKZ6SbujPWUYqHAAmoeFjH8kp44bp37y46rZIvv/xSJk+eLDBnQ1T3I2uvvbacd955smLFigqfK6+80kY9GDH98MMPaff3yy+/CBTLuQp8eB5//HFZsmSJjB49Wlq1aiX9+/eXW265RbANhLZs2bIKp/vuu++kUaNGFdYHrSC5BKES7ToSULT4x+LqmIZhinPXXXcJRgkY4UDw0sM6hBHQOuus43/g3AfSUmWt7Yd9pk+fbt+9PzfddJNZqlR35K3K+h9kpXokgfMgLG1oz9ixY41Y0C6MxjBNmjhxYto5VJ8jGB3BqkVJJgIkoGT2W7W2GtMqVSKbF/ExxxyTpsuByV2tXHLWWWfJxx9/LO+//76oRcm+77rrrtaOPn36yPjx4+XCCy+0URTM+zBt9+7d20ZRYY3FKAskc9FFF8m0adNErXNGRtBLQRcEQTswSoNuCXoiTPtgtoceBy4DlIQiUFgdN8+eFARg+dFH2KlCuUKTYXrXaZBth0kepm/1+0nbT6dKrk6dOrYPznPEEUc4mPlzFdUnOVVkO1iycLyOuJwSm29Zg/XrhhtusGvoyMwpaTn1TXKw2nkSZgVTovV2tf9wNcA5UkXJzKxvqev4vXAIrIZTJ5Q72ewiIoDH5LPPPhP198k6qoFCGqMWTKOUDPJqnZry5dNPPxU1y6eNxLyTecpvOBJi1ERJNgIkoGT3H1tPBBKNAP2AEt198W88fIjUm7nShl522WWm1K50J24sSQQ4AirJbo3PTWkoh6xatarSBsHyhmkbpfwQIAGVX5/zjolAbBCgGT42XcGGEIHyQ4AEVH59zjsmArFBgAQUm65gQ4hA+SFAAiq/PucdE4HYIEACik1XsCFEoPwQIAGVX5/zjolAbBAgAcWmK9gQIlB+CJCAyq/PecdEIDYIkIBi0xVsCBEoPwRIQOXX57xjIhAbBEhAsekKNoQIlB8CJKDy63PeMRGIDQIkoNh0BRtCBMoPARJQ+fU575gIxAYBElBsuoINIQLlhwAJqPz6nHdMBGKDAAkoNl3BhhCB8kOABFR+fc47JgKxQYAEFJuuYEOIQPkh8H9Yk9xuDiDWEwAAAABJRU5ErkJggg==" /><!-- --></p>
<p>Similar to above, the soil moisture dependence of LUE (and hence GPP,
and Vcmax) can be calculated directly using the function
<code>calc_soilmstress()</code> and affects several quantities returned
by the <code>rpmodel()</code> call (GPP, LUE, Vcmax):</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a>out_pmodel_soilmstress_OFF <span class="ot">&lt;-</span> <span class="fu">rpmodel</span>( </span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>  <span class="at">tc             =</span> <span class="dv">20</span>,           <span class="co"># temperature, deg C</span></span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>  <span class="at">vpd            =</span> <span class="dv">1000</span>,         <span class="co"># Pa,</span></span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>  <span class="at">co2            =</span> <span class="dv">400</span>,          <span class="co"># ppm,</span></span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>  <span class="at">fapar          =</span> <span class="dv">1</span>,            <span class="co"># fraction  ,</span></span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a>  <span class="at">ppfd           =</span> <span class="dv">30</span>,           <span class="co"># mol/m2/d,</span></span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a>  <span class="at">elv            =</span> <span class="dv">0</span>,            <span class="co"># m.a.s.l.,</span></span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a>  <span class="at">do_ftemp_kphio =</span> <span class="cn">FALSE</span>,</span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a>  <span class="at">do_soilmstress =</span> <span class="cn">FALSE</span></span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a>  )</span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a>out_pmodel_soilmstress_ON <span class="ot">&lt;-</span> <span class="fu">rpmodel</span>( </span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a>  <span class="at">tc             =</span> <span class="dv">20</span>,           <span class="co"># temperature, deg C</span></span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a>  <span class="at">vpd            =</span> <span class="dv">1000</span>,         <span class="co"># Pa,</span></span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a>  <span class="at">co2            =</span> <span class="dv">400</span>,          <span class="co"># ppm,</span></span>
<span id="cb58-15"><a href="#cb58-15" tabindex="-1"></a>  <span class="at">fapar          =</span> <span class="dv">1</span>,            <span class="co"># fraction  ,</span></span>
<span id="cb58-16"><a href="#cb58-16" tabindex="-1"></a>  <span class="at">ppfd           =</span> <span class="dv">30</span>,           <span class="co"># mol/m2/d,</span></span>
<span id="cb58-17"><a href="#cb58-17" tabindex="-1"></a>  <span class="at">elv            =</span> <span class="dv">0</span>,            <span class="co"># m.a.s.l.,</span></span>
<span id="cb58-18"><a href="#cb58-18" tabindex="-1"></a>  <span class="at">do_ftemp_kphio =</span> <span class="cn">FALSE</span>,</span>
<span id="cb58-19"><a href="#cb58-19" tabindex="-1"></a>  <span class="at">do_soilmstress =</span> <span class="cn">TRUE</span>,</span>
<span id="cb58-20"><a href="#cb58-20" tabindex="-1"></a>  <span class="at">soilm          =</span> <span class="fl">0.2</span>,</span>
<span id="cb58-21"><a href="#cb58-21" tabindex="-1"></a>  <span class="at">apar_soilm     =</span> <span class="fl">0.1</span>,</span>
<span id="cb58-22"><a href="#cb58-22" tabindex="-1"></a>  <span class="at">bpar_soilm     =</span> <span class="fl">0.7</span>,</span>
<span id="cb58-23"><a href="#cb58-23" tabindex="-1"></a>  <span class="at">meanalpha      =</span> <span class="fl">0.2</span> </span>
<span id="cb58-24"><a href="#cb58-24" tabindex="-1"></a>  )</span>
<span id="cb58-25"><a href="#cb58-25" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;LUE soilmstress_ON /LUE soilmstress_OFF =&quot;</span>, out_pmodel_soilmstress_ON<span class="sc">$</span>lue <span class="sc">/</span> out_pmodel_soilmstress_OFF<span class="sc">$</span>lue))</span></code></pre></div>
<pre><code>## [1] &quot;LUE soilmstress_ON /LUE soilmstress_OFF = &quot;</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;GPP soilmstress_ON /GPP soilmstress_OFF =&quot;</span>, out_pmodel_soilmstress_ON<span class="sc">$</span>gpp <span class="sc">/</span> out_pmodel_soilmstress_OFF<span class="sc">$</span>gpp))</span></code></pre></div>
<pre><code>## [1] &quot;GPP soilmstress_ON /GPP soilmstress_OFF = 0.662222222222222&quot;</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Vcmax soilmstress_ON /Vcmax soilmstress_OFF =&quot;</span>, out_pmodel_soilmstress_ON<span class="sc">$</span>vcmax <span class="sc">/</span> out_pmodel_soilmstress_OFF<span class="sc">$</span>vcmax))</span></code></pre></div>
<pre><code>## [1] &quot;Vcmax soilmstress_ON /Vcmax soilmstress_OFF = 0.662222222222222&quot;</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;soilmstress(0.2, apar_soilm = 0.1, bpar_soilm = 0.7, meanalpha = 0.2) =&quot;</span>, <span class="fu">calc_soilmstress</span>(<span class="fl">0.2</span>, <span class="at">apar_soilm =</span> <span class="fl">0.1</span>, <span class="at">bpar_soilm =</span> <span class="fl">0.7</span>, <span class="at">meanalpha =</span> <span class="fl">0.2</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;soilmstress(0.2, apar_soilm = 0.1, bpar_soilm = 0.7, meanalpha = 0.2) = 0.662222222222222&quot;</code></pre>
<p><code>ftemp_arrh()</code> Calculates the Arrhenius-type temperature
response.</p>
<!-- ## Response to CO2 -->
<!-- ```{r} -->
<!-- library(ggplot) -->
<!-- df <- tibble( -->
<!--   tc             = rep(20, 100), -->
<!--   vpd            = rep(1000, 100), -->
<!--   co2            = seq(360, 1000, length.out = 100), -->
<!--   fapar          = rep(1, 100), -->
<!--   ppfd           = rep(100, 100) -->
<!--   ) %>% -->
<!--   dplyr::mutate( out_pmodel_simpl = purrr::pmap(., rpmodel, -->
<!--     elv            = 0, -->
<!--     kphio          = 0.05, -->
<!--     beta           = 146, -->
<!--     method_optci   = "prentice14", -->
<!--     method_jmaxlim = "none", -->
<!--     do_ftemp_kphio = FALSE -->
<!--     ) ) %>% -->
<!--   dplyr::mutate( out_pmodel_full = purrr::pmap(dplyr::select(., 1:5), rpmodel,  -->
<!--     elv            = 0,          -->
<!--     kphio          = 0.05,          -->
<!--     beta           = 146, -->
<!--     method_optci   = "prentice14", -->
<!--     method_jmaxlim = "wang17", -->
<!--     do_ftemp_kphio = FALSE -->
<!--     ) ) %>%  -->
<!--   dplyr::mutate( out_pmodel_simpl = purrr::map(out_pmodel_simpl, ~as_tibble(.))) %>% -->
<!--   dplyr::mutate( out_pmodel_full  = purrr::map(out_pmodel_full,  ~as_tibble(.))) -->
<!-- df %>%  -->
<!--   tidyr::unnest(out_pmodel_full) %>%  -->
<!--   dplyr::select(co2, out_pmodel_simpl, gpp_full = gpp) %>%  -->
<!--   tidyr::unnest(out_pmodel_simpl) %>%  -->
<!--   dplyr::select(co2, gpp_full, gpp_simpl = gpp) %>%  -->
<!--   tidyr::gather(method, gpp, c(gpp_full, gpp_simpl)) %>%  -->
<!--   ggplot(aes(x = co2, y = gpp, color = method)) + -->
<!--   geom_line() -->
<!-- ``` -->
</div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Bernacchi, C. J., Pimentel, C., and Long, S. P.: In vivo temperature
response func-tions of parameters required to model RuBP-limited
photosynthesis, Plant Cell Environ., 26, 1419–1430, 2003</p>
<p>Cai, W., and Prentice, I. C.: Recent trends in gross primary
production and their drivers: analysis and modelling at flux-site and
global scales, Environ. Res. Lett. 15 124050
https://doi.org/10.1088/1748-9326/abc64e, 2020</p>
<p>Stocker, B. D., Wang, H., Smith, N. G., Harrison, S. P., Keenan, T.
F., Sandoval, D., Davis, T., and Prentice, I. C.: P-model v1.0: An
optimality-based light use efficiency model for simulating ecosystem
gross primary production, Geosci. Model Dev. Discuss., <a href="https://doi.org/10.5194/gmd-2019-200" class="uri">https://doi.org/10.5194/gmd-2019-200</a>, in review,
2019.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
